import{a as vt}from"./chunk-4V5HUOQ3.js";import{A as et,B as ot,C as q,D as I,E as rt,F as N,G as B,H as it,J as nt,M as U,P as V,S as G,T as ht,b as M,d as u,e as y,f as C,i as b,j as S,k as F,m as j,n as H,o as x,p as E,q as L,r as z,u as A,v as _,y as D,z as P}from"./chunk-YN5ULIRY.js";import{Da as O,Ha as p,L as m,La as W,Oa as e,Pa as r,Qa as l,Sb as tt,Ua as f,Vb as h,Wb as k,ae as at,be as mt,ce as R,d as c,gb as i,hb as $,he as lt,je as st,ke as ut,le as pt,me as dt,na as s,ne as ct,oe as ft,qd as v,qe as gt,rd as T,ud as w,xa as g}from"./chunk-HJUHHJF5.js";function St(a,bt){a&1&&(e(0,"mat-hint",6),i(1,"Passwords do not match"),r())}var wt=(()=>{class a{constructor(){this.router=m(h),this.formBuilder=m(j),this.afAuth=m(R),this.error="",this.form=this.formBuilder.group({password:["",u.required],confirmPassword:["",u.required]},{validator:this.passwordMissMatch})}passwordMissMatch(n){let o=n.get("password"),t=n.get("confirmPassword"),d={};return(o.touched||t.touched)&&o.value!==t.value&&t!==null&&(d={passwordMissMatch:!0}),d}changePassword(){return c(this,null,function*(){let n=yield this.afAuth.currentUser,o=this.form.get("password").value;this.error="";try{yield gt(n,o),this.router.navigateByUrl("/")}catch(t){t instanceof Error&&console.log("SignupComponent: Error updating password:"+t.message),this.error="Error updating password"}})}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=g({type:a,selectors:[["app-change-password"]],decls:20,vars:4,consts:[["title","Change Password"],[3,"error"],[3,"ngSubmit","formGroup"],["fxLayout","column","fxFlex","","fxLayoutAlign","space-around"],["matInput","","formControlName","password","type","password","autocomplete","on"],["matInput","","formControlName","confirmPassword","type","password"],[1,"error"],["fxLayout","row","fxLayoutAlign","space-between center"],["mat-flat-button","","type","submit","aria-label","Change Password",3,"disabled"]],template:function(o,t){o&1&&(l(0,"app-toolbar",0),e(1,"app-form-container",1)(2,"form",2),f("ngSubmit",function(){return t.changePassword()}),e(3,"div",3)(4,"mat-form-field")(5,"mat-label"),i(6,"Password"),r(),l(7,"input",4),e(8,"mat-error"),i(9,"Password required"),r()(),e(10,"mat-form-field")(11,"mat-label"),i(12,"Confirm Password"),r(),l(13,"input",5),e(14,"mat-error"),i(15,"Confirm password required"),r(),O(16,St,2,0,"mat-hint",6),r(),e(17,"div",7)(18,"button",8),i(19,"Set Password"),r()()()()()),o&2&&(s(),p("error",t.error),s(),p("formGroup",t.form),s(14),W(t.form.errors&&t.form.errors.passwordMissMatch?16:-1),s(2),p("disabled",t.form.invalid))},dependencies:[V,G,B,N,I,q,U,x,b,M,y,C,S,F,_,A,E,z,L,P,D,w,v],encapsulation:2})}}return a})();var Ft=new at,xt=new mt,Et=()=>window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),Mt=(()=>{class a{constructor(){this.route=m(tt),this.router=m(h),this.formBuilder=m(H),this.afAuth=m(R),this.loginForm=this.formBuilder.group({email:["",[u.required,u.email]],password:["",u.required]}),this.error="",this.loading=!1,this.returnUrl=""}ngOnInit(){this.route.queryParams.subscribe(n=>{this.returnUrl=n.returnUrl}),this.error=""}loginFormSubmit(){return c(this,null,function*(){this.loginForm.valid&&(yield this.signInWith("EmailAndPassword",this.loginForm.getRawValue()))})}signInWith(n,o){return c(this,null,function*(){try{switch(this.loading=!0,this.error="",n){case"EmailAndPassword":yield dt(this.afAuth,o.email,o.password);break;case"Google":yield this._thirdPartySignIn(xt);break;case"Facebook":yield this._thirdPartySignIn(Ft);break}this._handleSignInSuccess()}catch(t){this._handleSigninError(t)}finally{this.loading=!1}})}_thirdPartySignIn(n){return c(this,null,function*(){if(Et()){yield ft(this.afAuth,n);let o=yield st(this.afAuth);return o===null||o.user===null?null:o}else return yield ct(this.afAuth,n)})}_handleSigninError(n){console.log("LoginComponent: Error loging in.  Error code:"+ +n.code+"  "+n.message),this.error="Login attempt failed"}_handleSignInSuccess(){console.log("LoginComponent: Successful login"),this.error="",this.router.navigateByUrl(this.returnUrl)}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=g({type:a,selectors:[["app-login"]],decls:37,vars:2,consts:[["title","Login"],["fxLayout","column","fxLayoutAlign","start center","fxFlexFill",""],["fxLayout","column","fxLayoutAlign","space-around center","fxLayoutGap","10px"],[1,"error"],[3,"ngSubmit","formGroup"],["fxLayout","column","fxFlexFill","","fxLayoutAlign","center","fxLayoutGap","10px"],["matInput","","formControlName","email","type","email","autocomplete","on"],["matInput","","formControlName","password","type","password","autocomplete","on"],["fxLayout","row","fxLayoutAlign","center"],["mat-flat-button","","type","submit","aria-label","login"],["fxLayout","row","fxLayoutAlign","space-between"],["mat-button","","routerLink","/auth/recover"],["mat-button","","routerLink","/auth/signup"],[1,"horizontal_rule"],[1,"mat-title-medium"],["mat-flat-button","","fxFlexAlign","stretch",3,"click"]],template:function(o,t){o&1&&(l(0,"app-toolbar",0),e(1,"div",1)(2,"mat-card")(3,"mat-card-content")(4,"div",2)(5,"div",3),i(6),r(),e(7,"div",2)(8,"form",4),f("ngSubmit",function(){return t.loginFormSubmit()}),e(9,"div",5)(10,"mat-form-field")(11,"mat-label"),i(12,"Email"),r(),l(13,"input",6),e(14,"mat-error"),i(15,"Invalid email"),r()(),e(16,"mat-form-field")(17,"mat-label"),i(18,"Password"),r(),l(19,"input",7),e(20,"mat-error"),i(21,"Password required"),r()(),e(22,"div",8)(23,"button",9),i(24,"Sign In"),r()(),e(25,"div",10)(26,"a",11),i(27,"Forgot password?"),r(),e(28,"a",12),i(29,"Create account?"),r()()()()(),l(30,"div",13),e(31,"span",14),i(32,"OR LOGIN USING"),r(),e(33,"button",15),f("click",function(){return t.signInWith("Google")}),i(34,"GOOGLE"),r(),e(35,"button",15),f("click",function(){return t.signInWith("Facebook")}),i(36,"FACEBOOK"),r()()()()()),o&2&&(s(6),$(t.error),s(2),p("formGroup",t.loginForm))},dependencies:[U,it,nt,G,B,N,rt,I,ot,et,x,b,M,y,C,S,F,_,A,E,L,P,D,w,T,v,k],styles:[".horizontal_rule[_ngcontent-%COMP%]{border-bottom:1px solid rgb(209,209,209);width:100%;text-align:center}"]})}}return a})();var yt=(()=>{class a{constructor(){this.router=m(h),this.formBuilder=m(H),this.afAuth=m(R),this.snackBar=m(vt),this.recoverForm=this.formBuilder.group({email:["",[u.required,u.email]]})}recover(){return c(this,null,function*(){let n=this.recoverForm.value.email;try{yield pt(this.afAuth,n),this.router.navigate(["/auth/login"])}catch{console.log("RecoverComponent: Error requesting password reset for email"),this.snackBar.open("Error requesting password reset for email","Close",{duration:3e3})}})}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=g({type:a,selectors:[["app-recover"]],decls:16,vars:2,consts:[["title","Recover Your Password"],[3,"ngSubmit","formGroup"],["fxLayout","column","fxFlex","","fxLayoutAlign","space-around"],["matInput","","formControlName","email","type","email"],["fxLayout","row","fxLayoutAlign","space-between center"],["mat-flat-button","","type","submit","aria-label","login",3,"disabled"],["mat-button","","routerLink","/auth/login"]],template:function(o,t){o&1&&(l(0,"app-toolbar",0),e(1,"app-form-container")(2,"form",1),f("ngSubmit",function(){return t.recover()}),e(3,"div",2)(4,"mat-form-field")(5,"mat-label"),i(6,"Email"),r(),l(7,"input",3),e(8,"mat-error"),i(9,"Invalid email"),r()(),l(10,"BR"),e(11,"div",4)(12,"button",5),i(13,"Recover"),r(),e(14,"a",6),i(15,"Remembered your password?"),r()()()()()),o&2&&(s(2),p("formGroup",t.recoverForm),s(10),p("disabled",t.recoverForm.invalid))},dependencies:[B,N,I,q,x,b,M,y,C,S,F,U,_,A,E,L,P,D,w,T,v,k,V,G],encapsulation:2})}}return a})();function Lt(a,bt){a&1&&(e(0,"mat-hint",7),i(1,"Passwords do not match"),r())}var Ct=(()=>{class a{constructor(){this.router=m(h),this.formBuilder=m(j),this.afAuth=m(R),this.signupForm=this.formBuilder.group({email:["",[u.required,u.email]],password:["",u.required],confirmPassword:["",u.required]},{validator:this.passwordMissMatch}),this.error=""}passwordMissMatch(n){let o=n.get("password"),t=n.get("confirmPassword"),d={};return(o.touched||t.touched)&&o.value!==t.value&&t!==null&&(d={passwordMissMatch:!0}),d}signup(){return c(this,null,function*(){let n=this.signupForm.get("email").value,o=this.signupForm.get("password").value;this.error="";try{yield lt(this.afAuth,n,o);let t=this.afAuth.currentUser;t?yield ut(t):console.log("User enexpectely null"),this.router.navigateByUrl("/user")}catch(t){t instanceof Error?(console.log("SignupComponent: Error creating user code:"+t.message),this.error=t.message):console.log("SignupComponent: unexpected error")}})}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=g({type:a,selectors:[["app-signup"]],decls:28,vars:4,consts:[["title","OFixtures - registration"],[3,"error"],[3,"ngSubmit","formGroup"],["fxLayout","column","fxFlex","","fxLayoutAlign","space-around"],["matInput","","formControlName","email","type","email"],["matInput","","formControlName","password","type","password"],["matInput","","formControlName","confirmPassword","type","password"],[1,"error"],["fxLayout","row","fxLayoutAlign","space-between center"],["mat-flat-button","","type","submit","aria-label","Signup",3,"disabled"],["mat-button","","routerLink","/auth/login"]],template:function(o,t){o&1&&(l(0,"app-toolbar",0),e(1,"app-form-container",1)(2,"form",2),f("ngSubmit",function(){return t.signup()}),e(3,"div",3)(4,"mat-form-field")(5,"mat-label"),i(6,"Email"),r(),l(7,"input",4),e(8,"mat-error"),i(9,"Invalid email"),r()(),e(10,"mat-form-field")(11,"mat-label"),i(12,"Password"),r(),l(13,"input",5),e(14,"mat-error"),i(15,"Password required"),r()(),e(16,"mat-form-field")(17,"mat-label"),i(18,"Confirm Password"),r(),l(19,"input",6),e(20,"mat-error"),i(21,"Confirm password required"),r(),O(22,Lt,2,0,"mat-hint",7),r(),e(23,"div",8)(24,"button",9),i(25,"Sign up"),r(),e(26,"a",10),i(27,"Already have user name"),r()()()()()),o&2&&(s(),p("error",t.error),s(),p("formGroup",t.signupForm),s(20),W(t.signupForm.errors&&t.signupForm.errors.passwordMissMatch?22:-1),s(2),p("disabled",t.signupForm.invalid))},dependencies:[V,B,N,I,q,x,b,M,y,C,S,F,_,A,E,z,L,P,D,w,T,v,k,G],encapsulation:2})}}return a})();var Re=[{path:"login",component:Mt},{path:"signup",component:Ct},{path:"recover",component:yt},{path:"change-password",component:wt,canActivate:[ht]}];export{Re as AUTH_ROUTES};
