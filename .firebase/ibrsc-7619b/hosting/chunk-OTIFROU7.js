import{c as x,d as k,e as ot,f as st,g as mt}from"./chunk-LMMAYKRR.js";import{h as Z,k as tt,n as et,q as rt}from"./chunk-IWC2JBYH.js";import{D as $,E as W,F as z,G as H,N as J,P as K,R as it,S as at,T as nt,b as w,d as _,e as A,f as B,h as L,i as N,j as G,k as I,l as P,n as E,o as R,p as O,u as T,v as V,y as j,z as q}from"./chunk-YN5ULIRY.js";import{A as c,B as h,C as g,Da as M,H as v,Ha as l,L as o,La as b,Oa as s,Pa as m,Qa as u,Ua as D,Vb as F,cd as S,ce as X,d as a,fe as Y,gb as p,k as f,na as n,qd as C,ud as U,vd as Q,xa as y,zb as d}from"./chunk-HJUHHJF5.js";var ut=(()=>{class e{constructor(){this.auth=o(X),this.fs=o(Z),this.userdata$=Y(this.auth).pipe(g(t=>t?(console.log(`UserData: monitoring uid: ${t.uid}`),tt(this._doc(t.uid))):(console.log("UserData: Firebase user null.  Stop monitoring user date  "),f(null))),h(null),c(1)),this.userdata=Q(this.userdata$)}updateDetails(t){return a(this,null,function*(){if(this.userdata()){console.log("UserDataService: Saving user"+this.userdata().key);let r=this._doc(this.userdata().key);return rt(r,t)}else throw console.log("UserDataService: Saving user: Unexectly null"),Error("UserDataService: Saving user: Unexectly null")})}_doc(t){return et(this.fs,"users/"+t)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function dt(e,ft){e&1&&u(0,"mat-progress-bar",2)}var lt=(()=>{class e{constructor(){this.afAuth=o(ot),this.usd=o(ut),this.formBuilder=o(E),this.router=o(F),this.showProgressBar=!1,this.busy=!1,this.userForm=this.formBuilder.group({name:new L("",[_.required])}),d(()=>{let t=this.usd.userdata();t&&this.userForm.patchValue({name:t.name})}),d(()=>{this.afAuth.loggedIn()||this.router.navigate(["/"])})}save(){return a(this,null,function*(){this.busy=!0;try{yield this.usd.updateDetails(this.userForm.value),this.userForm.reset(),this.router.navigate(["/"])}finally{this.busy=!1}})}canDeactivate(){return!this.userForm.dirty}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=y({type:e,selectors:[["app-user"]],decls:11,vars:3,consts:[["title","User details"],["novalidate","","fxLayout","column","fxLayoutAlign","space-around","fxLayoutGap","10px",3,"ngSubmit","formGroup"],["mode","query"],["matInput","","required","","formControlName","name"],["fxLayout","row","fxLayoutAlign","space-between center"],["mat-flat-button","","type","submit","aria-label","login",3,"disabled"]],template:function(r,i){r&1&&(u(0,"app-toolbar",0),s(1,"app-form-container")(2,"form",1),D("ngSubmit",function(){return i.save()}),M(3,dt,1,0,"mat-progress-bar",2),s(4,"mat-form-field")(5,"mat-label"),p(6," Name"),m(),u(7,"input",3),m(),s(8,"div",4)(9,"button",5),p(10,"Save"),m()()()()),r&2&&(n(2),l("formGroup",i.userForm),n(),b(i.showProgressBar?3:-1),n(6),l("disabled",i.userForm.invalid||!i.userForm.dirty))},dependencies:[at,H,z,W,$,R,N,w,A,B,P,G,I,mt,st,V,T,O,q,j,U,C,it,J,k,S,K],styles:["mat-card[_ngcontent-%COMP%]{max-width:300px!important;width:100vw!important;min-width:150px!important}.title[_ngcontent-%COMP%]{font:var(--mat-sys-title-medium)}.icon[_ngcontent-%COMP%]{transform:scale(1.3)}"]})}}return e})();var Yt=[{path:"",component:lt,canActivate:[nt],canDeactivate:[x]}];export{Yt as USER_ROUTES};
